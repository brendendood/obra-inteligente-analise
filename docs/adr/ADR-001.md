# ADR-001: PadrÃ£o de MÃ³dulos e Boundaries

**Status**: Aceito  
**Data**: 2025-08-25  
**Decisores**: MadenAI Architecture Team

## ğŸ“‹ Contexto

O projeto MadenAI cresceu organicamente e desenvolveu inconsistÃªncias na organizaÃ§Ã£o de cÃ³digo:

- **DependÃªncias circulares** entre components, hooks e integrations
- **Acoplamento forte** entre camadas de UI e dados
- **Dificuldade de testes** devido a dependÃªncias complexas
- **InconsistÃªncia** na forma como diferentes mÃ³dulos acessam funcionalidades
- **Manutenibilidade comprometida** por violaÃ§Ãµes arquiteturais

### Problemas Identificados

1. Components acessando diretamente integraÃ§Ãµes (Supabase)
2. Hooks importando components (dependÃªncia circular)
3. Utils com dependÃªncias internas desnecessÃ¡rias
4. Integrations conhecendo detalhes de UI
5. AusÃªncia de camada de abstraÃ§Ã£o para APIs externas

## âš–ï¸ DecisÃ£o

Estabelecemos **hierarquia rÃ­gida de dependÃªncias** com boundaries claros:

### ğŸ¯ Hierarquia Definida
```
Pages â†’ Components â†’ Hooks â†’ Facades â†’ Integrations
  â†“         â†“         â†“        â†“
Utils â† Utils â† Utils â† Utils
```

### ğŸ“ Regras de DependÃªncia

1. **Components**:
   - âœ… Podem usar: Hooks, Utils, Facades
   - âŒ NÃ£o podem usar: Integrations diretas, Contexts via import

2. **Hooks**:
   - âœ… Podem usar: Utils, Integrations, Facades
   - âŒ NÃ£o podem usar: Components, Contexts via import

3. **Facades**:
   - âœ… Podem usar: Integrations, Utils
   - âŒ NÃ£o podem usar: Components, Hooks, React

4. **Integrations**:
   - âœ… Podem usar: Utils apenas
   - âŒ NÃ£o podem usar: Qualquer mÃ³dulo interno

5. **Utils**:
   - âœ… Podem usar: Bibliotecas externas apenas
   - âŒ NÃ£o podem usar: Qualquer mÃ³dulo interno

### ğŸ­ IntroduÃ§Ã£o de Facades

- **AuthFacade**: Abstrai operaÃ§Ãµes de autenticaÃ§Ã£o
- **ProjectFacade**: Abstrai operaÃ§Ãµes de projeto
- **AIFacade**: Abstrai interaÃ§Ãµes com IA/N8N
- **StorageFacade**: Abstrai operaÃ§Ãµes de arquivo

## âœ… ConsequÃªncias

### Positivas

1. **Testabilidade**: Cada mÃ³dulo pode ser testado isoladamente
2. **Manutenibilidade**: MudanÃ§as em uma camada nÃ£o afetam outras
3. **Clareza**: Responsabilidades bem definidas
4. **ReutilizaÃ§Ã£o**: Components independentes de contexto
5. **Substituibilidade**: IntegraÃ§Ãµes podem ser trocadas via facades

### Negativas

1. **Complexidade inicial**: Mais arquivos e abstraÃ§Ãµes
2. **Curva de aprendizado**: Desenvolvedores precisam entender boundaries
3. **Refactoring extenso**: CÃ³digo existente precisa ser reorganizado
4. **Overhead**: Camadas adicionais podem adicionar complexidade

### MitigaÃ§Ãµes

- **DocumentaÃ§Ã£o clara** de boundaries em `/docs/architecture/BOUNDARIES.md`
- **ESLint rules** para enforÃ§ar boundaries automaticamente
- **Refactoring gradual** com facades como ponte
- **Exemplos prÃ¡ticos** e templates para novos mÃ³dulos

## ğŸ”§ ImplementaÃ§Ã£o

1. **Fase 1**: Criar facades para integraÃ§Ãµes existentes
2. **Fase 2**: Migrar hooks para usar facades
3. **Fase 3**: Atualizar components para usar apenas hooks
4. **Fase 4**: Isolar integrations e utils
5. **Fase 5**: Configurar ESLint para enforÃ§ar boundaries

## ğŸ“Š MÃ©tricas de Sucesso

- Zero dependÃªncias circulares (analisadas via tooling)
- 100% de coverage em testes unitÃ¡rios para facades
- Tempo de build reduzido em 30%
- Componentes reutilizÃ¡veis aumentados em 50%

---

**RevisÃ£o**: Anual ou quando problemas significativos surgirem  
**ResponsÃ¡vel**: Architecture Team